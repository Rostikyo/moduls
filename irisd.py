# meta developer: @modwini
import json as JSON
import logging
from .. import loader, utils

logger = logging.getLogger(__name__)



def register(cb):
    cb(AutoIris())
@loader.tds
class AutoIris(loader.Module):
    """–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞—Ä–∞–∂–µ–Ω–∏—è –ò—Ä–∏—Å"""
    def __init__(self):
        self.config = loader.ModuleConfig(
            loader.ConfigValue(
                "Id_chat",
                None,
                lambda: "chat_id",
                validator=loader.validators.Hidden(),
            ),
        )
    strings = {

        "name": "AutoIris",

        "not_reply": "<emoji document_id=5215273032553078755>‚ùå</emoji> –ù–µ—Ç —Ä–µ–ø–ª–∞—è.",

        "not_args": "<emoji document_id=5215273032553078755>‚ùå</emoji> –ù–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.",

        "nolink": "<emoji document_id=5197248832928227386>üò¢</emoji> –ù–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –∂–µ—Ä—Ç–≤—É.",

        "hueta": "ü§î –ß—Ç–æ –∑–∞ —Ö—É–µ—Ç–∞?",

        "r.save":
            "<emoji document_id=5212932275376759608>ü¶†</emoji> –ñ–µ—Ä—Ç–≤–∞ <b><code>{}</code></b> —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.\n"
            "<b>‚ò£Ô∏è +{}{}</b> –±–∏–æ-–æ–ø—ã—Ç–∞.",
        "auto.save":
            "<emoji document_id=5212932275376759608>ü¶†</emoji> –ñ–µ—Ä—Ç–≤–∞ <b><code>{}</code></b> —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.\n"
            "<b>‚ò£Ô∏è {}+{}</b> –±–∏–æ-–æ–ø—ã—Ç–∞.",
        "search":
            "<emoji document_id=5212932275376759608>‚úÖ</emoji> –ñ–µ—Ä—Ç–≤–∞ <code>{}</code> –ø—Ä–∏–Ω–æ—Å–∏—Ç:\n"
            "<b>‚ò£Ô∏è +{} –±–∏–æ-–æ–ø—ã—Ç–∞.</b>\n"
            "üìÜ –î–∞—Ç–∞: <i>{}</i>",

        "nf": "<emoji document_id=5215273032553078755>‚ùé</emoji> –ñ–µ—Ä—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.",

        "no_user": "<emoji document_id=5215273032553078755>‚ùé</emoji> user {} don't exist.",

        "nous": "<emoji document_id=5215273032553078755>‚ùé</emoji> –ñ–µ—Ä—Ç–≤–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.",

        "anf": "<emoji document_id=5215329773366025981>ü§î</emoji> –∞ –∫–æ–≥–æ –∏—Å–∫–∞—Ç—å?..",

        "aicmd":
            "<b>ü•∑üèª</b> <a href='tg://openmessage?user_id={}'>{}</a>\n"
            "<b>üÜî:</b> <code>@{}</code>",
        "myid": "<b>My üÜî:</b> <code>@{}</code>",

        "guidedov":
            "<b>‚ùî –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–≤–µ—Ä–∫—É:</b>\n"
            "\n<b>{0}</b>  <code>–±–µ–π</code> | <code>–∫—É—Å</code>[—å–∞–π–Ω–∏] | <code>–∑–∞—Ä–∞–∑–∏</code>[—Ç—å—Ç—å] "  # üîΩ
            "| <code>–µ–±</code>[–Ω–∏–∞–∂—à—å] | <code>—É–µ–±</code>[–∂–∏–∞–æ—à—Ç—å] [1-10] (@id|@user|link)"
            "\n<b>{0}</b>  <code>—Ü–µ–Ω</code>[–∞—É] | <code>–≤—á</code>[–µ–∫]  <i>(—Ü–µ–Ω–∞ –≤–∞–∫—Ü–∏–Ω—ã)</i>"
            "\n<b>{0}</b>  <code>–≤–∞–∫</code>[—Ü–∏–Ω–∞—É] | <code>–ª–µ—á</code>[–∏—Å—å] | <code>—Ö–∏</code>[–ª–ª—å—Å—è–π–∏–Ω–≥] | <code>–ª–µ–∫</code>[–∞—Ä—Å—Ç–≤–æ]"
            "\n<b>{0}</b>  <code>–∂–µ—Ä—Ç–≤</code>[—ã–∞—É] | <code>–µ–∂</code>[–∞—É]"
            "\n<b>{0}</b>  <code>–±–æ–ª</code>[–µ–∑—å–Ω–∏]"
            "\n<b>{0}</b>  <code>#–ª–∞–±</code>[—É–∞] | <code>%–ª–∞–±</code>[—É–∞] | <code>/–ª–∞–±</code>[—É–∞]"
            "\n<b>{0}</b>  <code>—É–≤–µ–¥</code>[—ã–∞–æ–º–ª–µ–Ω–∏—è]  <i>(+–≤–∏—Ä—É—Å—ã)</i>"
            "\n<b>{0}</b>  <code>-–≤–∏—Ä—É—Å</code>[—ã–∞]\n\n"
            "„ÄΩÔ∏è <b>–ê–ø–≥—Ä–µ–π–¥ –Ω–∞–≤—ã–∫–æ–≤:</b>\n"
            "<b>{0}  –Ω–∞–≤—ã–∫ (0-5)</b> –∏–ª–∏\n<b>{0}  —á–µ–∫ –Ω–∞–≤—ã–∫ (0-5)</b>\n"
            "<i> –ù–∞–ø—Ä–∏–º–µ—Ä: <b>{0} –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è 4</b>\n"
            "(—É–ª—É—á—à–∞–µ—Ç –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—é —É—á—ë–Ω–Ω—ã—Ö –Ω–∞ 4 —É—Ä.)</i>\n\n"
            "„ÄΩÔ∏è <b>–î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–∞–≤—ã–∫–∏:</b>\n"
            "üß™ –ü–∞—Ç–æ–≥–µ–Ω (<b>–ø–∞—Ç</b> [–æ–≥–µ–Ω—ã])\nüë®‚Äçüî¨ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è (<b>–∫–≤–∞–ª</b> [–∏—Ñ–∏–∫–∞—Ü–∏—è—É–ª–∞] | <b>—Ä–∞–∑—Ä–∞–±</b> [–æ—Ç–∫–∞—É])\n"
            "ü¶† –ó–∞—Ä–∞–∑–Ω–æ—Å—Ç—å (<b>–∑–∑</b> | <b>–∑–∞—Ä–∞–∑</b> [–∞–Ω–æ—Å—Ç—å–∫—É])\nüõ° –ò–º–º—É–Ω–∏—Ç–µ—Ç (<b>–∏–º–º—É–Ω</b> [–∏—Ç–µ—Ç–∫–∞—É])\n"
            "‚ò†Ô∏è –õ–µ—Ç–∞–ª—å–Ω–æ—Å—Ç—å (<b>–ª–µ—Ç–∞–ª</b> [—å–Ω–æ—Å—Ç—å–∫–∞—É])\nüïµÔ∏è‚Äç‚ôÇÔ∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (<b>—Å–±</b> | <b>—Å–ª—É–∂–±</b> [–∞—É] | <b>–±–µ–∑–æ–ø–∞—Å–Ω–æ</b> [—Å—Ç—å])\n\n"
            "<b>üîé –ü–æ–∏—Å–∫ –∂–µ—Ä—Ç–≤ –≤ –∑–∞—Ä–ª–∏—Å—Ç–µ:</b>\n"
            "<b>{0}  –∑ [ @id ]</b> –∏–ª–∏\n"
            "<b>{0}  –∑ [ —Ä–µ–ø–ª–∞–π ]</b>\n"
            "<i>—Å–º. <code>{1}config bio</code> –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.</i>",

        "dov":
            "<b>üåò <code>{5}–î–æ–≤ —Å–µ—Ç</code> [ id|—Ä–µ–ø–ª–∞–π ]</b> --- <b>–î–æ–±–∞–≤–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å —Å–∞–ø–ø–æ—Ä—Ç–∞.</b>\n"
            "<i>   ‚ú® –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:</i>\n"
            "{0}\n\n"
            "<b>üåò <code>{5}–î–æ–≤ –Ω–∏–∫</code> –Ω–∏–∫</b> --- <b>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∏–∫</b>.\n <i>–ù–∞–ø—Ä–∏–º–µ—Ä: <b><code>.–î–æ–≤ –Ω–∏–∫ {3}</code></b></i>.\n"
            "<b>   üî∞ –í–∞—à –Ω–∏–∫: <code>{1}</code></b>\n\n"
            "<b>üåò <code>{5}–î–æ–≤ –ø—É—Å–∫</code></b> --- <b>–ó–∞–ø—É—Å—Ç–∏—Ç—å/–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</b>.\n"
            "<b>   {2}</b>\n"
            "<i><b>–î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç –∫:</b></i>\n{4}",

        "zarlistHelp":
            "<b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∑–∞—Ä–ª–∏—Å—Ç–æ–º:</b>\n\n"
            "<i>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤—Å–µ –Ω–æ–≤—ã–µ –∂–µ—Ä—Ç–≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–Ω–æ—Å—è—Ç—Å—è –≤ –∑–∞—Ä–ª–∏—Å—Ç,"
            " –∫—Ä–æ–º–µ, –∫–æ–≥–¥–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –∏—Ä–∏—Å–∞ –æ –∑–∞—Ä–∞–∂–µ–Ω–∏–∏ –Ω–µ—Ç—É —Å—Å—ã–ª–∫–∏ –Ω–∞ –∂–µ—Ä—Ç–≤—É.</i>\n\n"
            "–®–∞–±–ª–æ–Ω—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ä—Ç–≤—ã:\n"
            "{0}–∑–∞—Ä @id 1.1–∫\n"
            "–∂–¥ @id 1.1–∫\n\n"
            "–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∂–µ—Ä—Ç–≤—É –∏—Å–ø–æ–ª—å–∑—É–π:\n"
            "{0}–∑–∞—Ä @id/—Ä–µ–ø–ª–∞–π —Ñ\n"
            "{1} –∑ @id/—Ä–µ–ø–ª–∞–π\n"
            "–∂–ª @id/—Ä–µ–ø–ª–∞–π\n\n"
            "–¢–∞–∫–∂–µ, –∏–Ω—Ñ—É –æ –±–æ–Ω—É—Å–µ —Å –∂–µ—Ä—Ç–≤—ã –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ä—è–¥–æ–º —Å –∏–º–µ–Ω–µ–º –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã {0}–±",

        "user_rm": "‚ùé –°–∞–ø–ø–æ—Ä—Ç <b><code>{}</code></b> —É–¥–∞–ª—ë–Ω.",

        "user_add": "<emoji document_id=5212932275376759608>‚úÖ</emoji> –°–∞–ø–ø–æ—Ä—Ç <b><code>{}</code></b> –¥–æ–±–∞–≤–ª–µ–Ω!",

        "wrong_nick": "<b>üìù –í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫.</b>",

        "nick_add": "üî∞ –ù–∏–∫ <b>{}</b> —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!",

        "dov_start": "<b><emoji document_id=5212932275376759608>‚úÖ</emoji> –£—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–æ!</b>",

        "dov_stop": "<b>‚ùé –£—Å–ø–µ—à–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.</b>",

        "dov.wrong_args":
            "<b><emoji document_id=5215273032553078755>‚ùå</emoji> –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç.</b>\n"
            "<i>üìù –í–≤–µ–¥–∏—Ç–µ <code>.–¥–æ–≤</code> –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–∞–Ω–¥.</i>",

        "wrong_id": "üëÄ –ü—Ä–∞–≤–∏–ª—å–Ω–æ üÜî –≤–≤–µ–¥–∏, –¥—É–±–∏–Ω–∞.",

        "ex": "‚ùé –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: <code>{}</code>",

        "wrong_ot-do": '<emoji document_id=5215273032553078755>‚ùå</emoji> –µ–±–ª–∞–Ω, –ò—Å–ø–æ–ª—å–∑—É–π <b>–ø—Ä–∞–≤–∏–ª—å–Ω–æ</b> —Ñ—É–Ω–∫—Ü–∏—é "–æ—Ç-–¥–æ".',

        "no_sargs": "<emoji document_id=5215273032553078755>‚ùå</emoji> –ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏.",

        "no_link": "<emoji document_id=5215273032553078755>‚ùå</emoji> –°—Å—ã–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.",

        "too_much_args": "<emoji document_id=5215273032553078755>‚ùå</emoji> –ö–æ–ª-–≤–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ <b>–±–æ–ª—å—à–µ</b> –æ–¥–Ω–æ–≥–æ, –ª–∏–±–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è <b>–Ω–µ</b> —Å–æ –∑–Ω–∞–∫–∞ <code>@</code>",

        "no_zar_reply": "<emoji document_id=5215273032553078755>‚ùå</emoji> –ù–µ—Ç —Ä–µ–ø–ª–∞—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏—Ä–∏—Å–∞ –æ –∑–∞—Ä–∞–∂–µ–Ω–∏–∏.",

        "empty_zar": "<emoji document_id=5215273032553078755>‚ùå</emoji> –°–ø–∏—Å–æ–∫ –∑–∞—Ä–∞–∂–µ–Ω–∏–π –ø—É—Å—Ç.",

        "wrong_zar_reply": '<emoji document_id=5215273032553078755>‚ùå</emoji> –†–µ–ø–ª–∞–π <b>–Ω–µ</b> –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏—Ä–∏—Å–∞ –æ –∑–∞—Ä–∞–∂–µ–Ω–∏–∏ "<b>...–ø–æ–¥–≤–µ—Ä–≥ –∑–∞—Ä–∞–∂–µ–Ω–∏—é...</b>"',

        "wrong_cmd": "<emoji document_id=5215273032553078755>‚ùå</emoji> –ö–æ–º–∞–Ω–¥–∞ –≤–≤–µ–¥–µ–Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.",

        "empty_ex": "<emoji document_id=5215273032553078755>‚ùå</emoji> C–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—É—Å—Ç.",

        "tids": "<b><emoji document_id=5212932275376759608>‚úÖ</emoji> Id'—ã —É—Å–ø–µ—à–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω—ã.</b>",

        "tzar": "<emoji document_id=5212932275376759608>‚úÖ</emoji> –ó–∞—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω—ã.",

        "clrex": "‚ùé –°–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –æ—á–∏—â–µ–Ω.",

        "zar_rm": "‚ùé –ñ–µ—Ä—Ç–≤–∞ <b><code>{0}</code></b> {1}—É–¥–∞–ª–µ–Ω–∞.",

        "exadd": "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å <code>{}</code> –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö.",

        "exrm": "‚ùé –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å <code>{}</code> —É–¥–∞–ª–µ–Ω.",

        "clrzar": "‚úÖ –ó–∞—Ä–ª–∏—Å—Ç <b>–æ—á–∏—â–µ–Ω</b>.",

        "guide":
            "<b>–ü–æ–º–æ—â—å –ø–æ –º–æ–¥—É–ª—é BioHelper:</b>\n\n"
            "<code>{0}biohelp –¥–æ–≤</code> üëà –ü–æ–º–æ—â—å –ø–æ –¥–æ–≤–µ—Ä–∫–µ\n"
            "<code>{0}biohelp –∑–∞—Ä–ª–∏—Å—Ç</code> üëà –ü–æ–º–æ—â—å –ø–æ –∑–∞—Ä–ª–∏—Å—Ç—É"

    }

    async def client_ready(self, client, db):
        self.db = db
        self.client = client

    async def idcmd(self, message):
        """—É–∑–Ω–∞—Ç—å –∞–π–¥–∏ —á–∞—Ç–∞"""
        chatt = str(message.chat_id)[1:]
        await message.reply(chatt)

    async def watche(self, message):
        """–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –ø–æ—á–µ–º—É –æ–Ω –∏–º–µ–Ω–Ω–æ watche –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è... ü§î"""
        gf = message.text
        id_chat = str(message.chat_id)[1:]
        if id_chat == self.config["Id_chat"]:
            if "üïµÔ∏è‚Äç‚ôÇÔ∏è" in gf:
                exlist = self.db.get("NumMod", "exUsers")
                err = "1"
                json = JSON.loads(message.to_json())
                try:
                    for i in range(len(message.entities)):
                        try:
                            link = json["entities"][i]["url"]
                            if link.startswith('tg'):
                                users = '@' + link.split('=')[1]
                                if users in exlist:
                                    await message.reply(
                                        self.strings("ex").format(
                                            users
                                        )
                                    )
                                else:
                                    await message.reply(f'/–∑–∞—Ä–∞–∑–∏—Ç—å {users}')
                            elif link.startswith('https://t.me'):
                                a = '@' + str(link.split("/")[3])
                                if a in exlist:
                                    await message.reply(
                                        self.strings("ex").format(
                                            a
                                        )
                                    )
                                else:
                                    await message.reply(f'/–∑–∞—Ä–∞–∑–∏—Ç—å {a}')
                            else:
                                await message.reply(
                                    self.strings("hueta")
                                )
                        except Exception:
                            blayt = message.raw_text[
                                    json["entities"][i]["offset"]:json["entities"][i]["offset"] + json["entities"][i][
                                        "length"]]
                            if blayt in exlist:
                                await message.reply(
                                    self.strings("ex").format(
                                        blayt
                                    )
                                )
                            else:
                                await message.reply(f"/–∑–∞—Ä–∞–∑–∏—Ç—å {blayt}")
                        await asyncio.sleep(3.3)

                except TypeError:
                    err = "2"
                    await message.reply(
                        self.strings("hueta")
                    )
                if err != "2":
                    await message.delete()
